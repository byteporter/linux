// SPDX-License-Identifier: (GPL-2.0+ OR X11)
/*
 * Copyright 2019 James Lind <james@byteporter.com>
 */

/dts-v1/;

#include "suniv-f1c100s.dtsi"
#include <dt-bindings/clock/suniv-ccu-f1c100s.h>
#include <dt-bindings/reset/suniv-ccu-f1c100s.h>

/ {
    model = "Miyoo PocketGo";
    compatible = "miyoo,miyoo-pocketgo", "allwinner,suniv-f1c100s";

    aliases {
        serial1 = &uart1;
    };

    chosen {
        stdout-path = "serial1:115200n8";
    };

    vcc3v3: vcc3v3 {
        compatible = "regulator-fixed";
        regulator-name = "vcc3v3";
        regulator-min-microvolt = <3300000>;
        regulator-max-microvolt = <3300000>;
    };
};

&{/soc} {
// This node exists in the miyoo stock device tree but I don't think there's ever actually been a
// 'suniv-dma' binding so I'm not sure what the purpose was. Possibly the 'daemon' program looks for it
// for some reason, but the dma controller doesn't seem to be implemented in any kernel I've seen

//    dma: dma-controller@1c02000 {
//        compatible = "allwinner,suniv-dma";
//        reg = <0x01c02000 0x00001000>;
//        #dma-cells = <1>;
//    };

    mmc0: mmc@1c0f000 {
        compatible = "allwinner,suniv-f1c100s-mmc", "allwinner,sun7i-a20-mmc";
        reg = <0x01c0f000 0x00001000>;
        clocks = <&ccu CLK_BUS_MMC0>, <&ccu CLK_MMC0>, <&ccu CLK_MMC0_OUTPUT>, <&ccu CLK_MMC0_SAMPLE>;
        clock-names = "ahb", "mmc", "output", "sample";
        resets = <&ccu RST_BUS_MMC0>;
        reset-names = "ahb";
        interrupts = <23>;
        pinctrl-names = "default";
        pinctrl-0 = <&mmc0_pins>;
        status = "okay";
        #address-cells = <1>;
        #size-cells = <0>;
        vmmc-supply = <&vcc3v3>;
        bus-width = <4>;
        broken-cd;
    };
};

&pio {
    mmc0_pins: mmc-pins {
        pins = "PF0", "PF1", "PF2", "PF3", "PF4", "PF5";
        function = "mmc0";
    };

    uart1_pa_pins: uart1-pa-pins {
        pins = "PA2", "PA3";
        function = "uart1";
    };
};

&uart1 {
    pinctrl-names = "default";
    pinctrl-0 = <&uart1_pa_pins>;
    status = "okay";
};

